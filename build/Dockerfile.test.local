FROM untangleinc/packetd:build-glibc

RUN apt-get update -q --allow-releaseinfo-change

RUN apt-get install -y untangle-python3-sync-settings
RUN apt-get install -y untangle-geoip-database
RUN apt-get install -y libzmq5

# FIXME: target OS not correct right now
RUN mkdir /etc/config
RUN touch /etc/init.d/network

COPY cmd/reportd/reportd* /usr/bin/
COPY build/entrypoint-test.sh /usr/bin/

EXPOSE 80

ENTRYPOINT [ "entrypoint-test.sh" ]
